import{j as e,r as c,N as b,d as w,s as h,k as v}from"./index-DF1D02Hj.js";import{C as S}from"./CustomDataGrid-CNTFpQZZ.js";import{s as u}from"./styled-CPBbA9UG.js";import{C as A,a as N}from"./CardContent-Be-YTDra.js";import{B as g}from"./Box-D4cKv5_V.js";import{T as l}from"./Typography-D94uCwLm.js";import{G as j}from"./TextField-BCa7AWxh.js";import{b as B}from"./Menu-C7haSOWu.js";import{B as y}from"./Button-DJQ79VO-.js";import{a as x}from"./axios-CyFV80k_.js";import"./Paper-C9iPag-B.js";import"./useThemeProps-B6NQfqaC.js";import"./useThemeProps-wCF_0idl.js";import"./getThemeProps-60JEWZhT.js";import"./toPropertyKey-PLuKRk1e.js";import"./OutlinedInput-BKrgIPXM.js";import"./isMuiElement-DtCTRzqF.js";import"./mergeSlotProps-BtuCJPHe.js";import"./IconButton-CVXum2NQ.js";import"./Tooltip-BYenHq1v.js";import"./useSlotProps-C21nwL-b.js";import"./Toolbar-D268zmC0.js";import"./MenuItem-BDtCcL-v.js";import"./Chip-BCCKjiS7.js";import"./ListItemText-DboCFKAP.js";import"./InputAdornment-DbWrX7NJ.js";import"./CircularProgress-C94875X6.js";import"./KeyboardArrowRight-nCMYu8V0.js";import"./TableCell-CbZ5-y0A.js";import"./createStyled-93osxTnM.js";const E={Admin:"مسؤول",User:"مستخدم"},U=t=>new Date(t).toLocaleDateString("ar-EG"),D=u(A)({maxWidth:600,width:"300px",margin:"auto",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",borderRadius:16,overflow:"hidden"}),k=u(g)({backgroundColor:"#1976d2",color:"#ffffff",padding:"16px",textAlign:"center"}),T=u(N)({padding:0}),z=({user:t})=>e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(l,{variant:"h5",component:"div",children:"بطاقة هوية المستخدم"})}),e.jsxs(T,{children:[e.jsx(j,{container:!0,spacing:0,alignItems:"center",children:e.jsxs(j,{item:!0,xs:7,m:2,children:[e.jsx(l,{variant:"h6",component:"div",children:t.name}),e.jsx(l,{color:"text.secondary",children:t.role})]})}),e.jsxs(g,{mt:2,ml:2,px:2,pb:2,children:[e.jsxs(l,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"البريد الالكتروني:"})," ",t.email]}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"تاريخ انشاء الحساب:"})," ",U(t.created_at)]})]})]})]}),I=({users:t,handleDeleteClick:i})=>{const[o,n]=c.useState(null),s=r=>{n(r)},d=()=>{n(null)},p=[{field:"name",headerName:"الاسم",align:"left",flex:1},{field:"email",headerName:"البريد الالكتروني",align:"left",flex:1},{field:"role",headerName:"نوع المستخدم",align:"left",flex:.7,renderCell:r=>E[r.value]},{field:"created_at",headerName:"تاريخ انشاء الحساب",align:"left",flex:1,renderCell:r=>U(r.value)},{field:"actions",headerName:"الاعدادات",align:"left",flex:2,renderCell:r=>e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"tableBtn",onClick:()=>s(r.row),children:"تفاصيل"}),e.jsx(y,{className:"tableBtn",onClick:()=>i(r.row.id),children:"حذف"})]})}],m=t.map(r=>({...r}));return t.length===0?e.jsx(b,{}):e.jsxs("div",{className:"table-wrapper",style:{flex:1,overflow:"hidden"},children:[e.jsx("h1",{style:{marginBottom:"20px"},children:"المستخدمون"}),e.jsx(S,{getRowId:r=>r.id,rows:m,columns:p,initialState:{pagination:{paginationModel:{page:0,pageSize:5}}},pageSizeOptions:[5,8,11]}),e.jsx(B,{open:o!==null,onClose:d,"aria-labelledby":"user-details-modal","aria-describedby":"user-details-description",children:e.jsx(g,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxWidth:"90%",maxHeight:"90%",overflow:"auto"},children:o&&e.jsx(z,{user:o})})})]})},_=()=>{const t=sessionStorage.getItem("accessToken");return{getAllUsers:async()=>(await x.get("/api/All_Users",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).data,updateUser:async s=>(await x.post(`/api/Edit_User/${s.id}`,s,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"multipart/form-data"}})).data,deleteUser:async s=>{await x.post(`/api/Delete_User/${s}`,{},{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})}}},me=()=>{const[t,i]=c.useState([]),[o,n]=c.useState(!0),s=w(),{getAllUsers:d,deleteUser:p}=_();c.useEffect(()=>{m()},[]);const m=async()=>{try{n(!0);const a=await d();i(a)}catch(a){console.error("Error fetching User:",a),h.fire({icon:"error",title:"Failed to fetch User"})}finally{n(!1)}},r=a=>{s("/SystemAdmin/EditUser",{state:{editData:a}})},C=async a=>{try{await p(a),i(t.filter(f=>f.id!==a)),h.fire({icon:"success",title:"User data removed successfully."})}catch(f){console.error("Error deleting User:",f),h.fire({icon:"error",title:"Failed to delete User"})}};return o?e.jsx(v,{}):e.jsx(I,{users:t,handleEditClick:r,handleDeleteClick:C})};export{me as default};
