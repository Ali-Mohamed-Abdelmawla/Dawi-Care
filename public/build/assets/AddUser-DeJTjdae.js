import{r as S,j as e,d as P,s as w}from"./index-DF1D02Hj.js";import{a as T,C as u,u as W}from"./index.esm-Bs_MGDSt.js";import{a as k}from"./axios-CyFV80k_.js";import{d as B}from"./AddBoxTwoTone-D1J65XFy.js";import{d as v,a as C}from"./VisibilityOff-DKi6BRV9.js";import{u as F}from"./Paper-C9iPag-B.js";import{B as D}from"./Box-D4cKv5_V.js";import{T as V}from"./Typography-D94uCwLm.js";import{G as l,T as p}from"./TextField-BCa7AWxh.js";import{F as c,a as h}from"./OutlinedInput-BKrgIPXM.js";import{I as A}from"./InputAdornment-DbWrX7NJ.js";import{I as y}from"./IconButton-CVXum2NQ.js";import{L as _}from"./LoadingButton-BPIyvWo9.js";import"./createSvgIcon-QGnDfLuw.js";import"./isMuiElement-DtCTRzqF.js";import"./mergeSlotProps-BtuCJPHe.js";import"./Menu-C7haSOWu.js";import"./useSlotProps-C21nwL-b.js";import"./Button-DJQ79VO-.js";import"./CircularProgress-C94875X6.js";const $=({control:r,handleSubmit:i,onSubmit:x,loading:f})=>{const g=F(),[d,j]=S.useState(!1),a=()=>j(s=>!s),m=s=>{s.preventDefault()},[o,n]=S.useState(!1),b=()=>n(s=>!s),I=T({control:r,name:"password",defaultValue:""});return e.jsxs(D,{sx:{maxWidth:800,margin:"auto",padding:3},children:[e.jsx(V,{variant:"h4",gutterBottom:!0,pb:1,sx:{borderBottom:1,borderColor:g.palette.dividerColor.main},children:"إضافة مستخدم"}),e.jsxs("form",{onSubmit:i(x),children:[e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"name",control:r,defaultValue:"",rules:{required:"الاسم مطلوب"},render:({field:s,fieldState:{error:t}})=>e.jsxs(c,{fullWidth:!0,error:!!t,children:[e.jsx(p,{...s,label:"الاسم",variant:"outlined",fullWidth:!0,margin:"normal"}),t&&e.jsx(h,{children:t.message})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"email",control:r,defaultValue:"",rules:{required:"البريد الالكتروني مطلوب",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"يجب إدخال بريد إلكتروني صالح"}},render:({field:s,fieldState:{error:t}})=>e.jsxs(c,{fullWidth:!0,error:!!t,children:[e.jsx(p,{...s,label:"البريد الالكتروني",type:"email",variant:"outlined",fullWidth:!0,margin:"normal"}),t&&e.jsx(h,{children:t.message})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"password",control:r,defaultValue:"",rules:{required:"كلمة المرور مطلوبة",minLength:{value:8,message:"يجب أن تتكون كلمة المرور من 8 أحرف على الأقل"},validate:{hasLowerCase:s=>/[a-z]/.test(s)||"يجب أن تحتوي كلمة المرور على حرف صغير واحد على الأقل",hasUpperCase:s=>/[A-Z]/.test(s)||"يجب أن تحتوي كلمة المرور على حرف كبير واحد على الأقل",hasNumber:s=>/\d/.test(s)||"يجب أن تحتوي كلمة المرور على رقم واحد على الأقل",hasSpecialChar:s=>/[@$!%*?&]/.test(s)||"يجب أن تحتوي كلمة المرور على رمز خاص واحد على الأقل (@$!%*?&)"}},render:({field:s,fieldState:{error:t}})=>e.jsxs(c,{fullWidth:!0,error:!!t,children:[e.jsx(p,{...s,label:"كلمة المرور",type:d?"text":"password",variant:"outlined",fullWidth:!0,margin:"normal",InputProps:{endAdornment:e.jsx(A,{position:"end",children:e.jsx(y,{"aria-label":"toggle password visibility",onClick:a,onMouseDown:m,edge:"end",children:d?e.jsx(v,{}):e.jsx(C,{})})})}}),t&&e.jsx(h,{children:t.message})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"confirm_password",control:r,defaultValue:"",rules:{required:"تأكيد كلمة المرور مطلوب",validate:s=>s===I||"كلمات المرور غير متطابقة"},render:({field:s,fieldState:{error:t}})=>e.jsxs(c,{fullWidth:!0,error:!!t,children:[e.jsx(p,{...s,label:"تأكيد كلمة المرور",type:o?"text":"password",variant:"outlined",fullWidth:!0,margin:"normal",InputProps:{endAdornment:e.jsx(A,{position:"end",children:e.jsx(y,{"aria-label":"toggle password visibility",onClick:b,onMouseDown:m,edge:"end",children:o?e.jsx(v,{}):e.jsx(C,{})})})}}),t&&e.jsx(h,{children:t.message})]})})})]}),e.jsx(_,{endIcon:e.jsx(B,{}),loading:f,loadingPosition:"end",variant:"contained",type:"submit",sx:{mt:2},children:e.jsx("span",{children:"إضافة المستخدم"})})]})]})},ae=()=>{const[r,i]=S.useState(!1),{control:x,getValues:f,handleSubmit:g}=W(),d=P(),j=a=>{const m=sessionStorage.getItem("accessToken");i(!0);const o=new FormData;o.append("name",a.name),o.append("email",a.email.toString()),o.append("password",a.password.toString()),console.log(a),k.post("/api/Add_User",o,{headers:{Authorization:`Bearer ${m}`,"Content-Type":"multipart/form-data"},params:{name:a.name,email:a.email,password:a.password}}).then(n=>{n.status===200&&(i(!1),w.fire({icon:"success",title:"تم إضافة الموظف بنجاح"}).then(()=>{d("/SystemAdmin/Users")}))}).catch(n=>{i(!1),console.log(n),console.log(n.response.data.message),n.response.data.message.includes("The email has already been taken")?w.fire({icon:"error",title:"خطأ",text:"البريد الالكتروني مسجل من قبل"}).then(()=>{}):w.fire({icon:"error",title:"خطأ",text:"يرجى المحاولة مرة أخرى"})})};return e.jsx($,{control:x,getValues:f,handleSubmit:g,onSubmit:j,loading:r})};export{ae as default};
