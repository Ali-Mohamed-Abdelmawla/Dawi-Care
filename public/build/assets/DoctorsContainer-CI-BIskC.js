import{r as p,j as e,N as w,d as v,s as u,k as D}from"./index-DF1D02Hj.js";import{C as S}from"./CustomDataGrid-CNTFpQZZ.js";import{s as f}from"./styled-CPBbA9UG.js";import{C as N,a as k}from"./CardContent-Be-YTDra.js";import{B as h}from"./Box-D4cKv5_V.js";import{T as l}from"./Typography-D94uCwLm.js";import{G as j}from"./TextField-BCa7AWxh.js";import{A as C}from"./Avatar-B-QZB_q1.js";import{C as I}from"./Chip-BCCKjiS7.js";import{b}from"./Menu-C7haSOWu.js";import{B as y}from"./Button-DJQ79VO-.js";import{u as _}from"./useDoctorApi-BGMsDjy1.js";import"./Paper-C9iPag-B.js";import"./useThemeProps-B6NQfqaC.js";import"./useThemeProps-wCF_0idl.js";import"./getThemeProps-60JEWZhT.js";import"./toPropertyKey-PLuKRk1e.js";import"./OutlinedInput-BKrgIPXM.js";import"./isMuiElement-DtCTRzqF.js";import"./mergeSlotProps-BtuCJPHe.js";import"./IconButton-CVXum2NQ.js";import"./Tooltip-BYenHq1v.js";import"./useSlotProps-C21nwL-b.js";import"./Toolbar-D268zmC0.js";import"./MenuItem-BDtCcL-v.js";import"./ListItemText-DboCFKAP.js";import"./InputAdornment-DbWrX7NJ.js";import"./CircularProgress-C94875X6.js";import"./KeyboardArrowRight-nCMYu8V0.js";import"./TableCell-CbZ5-y0A.js";import"./createStyled-93osxTnM.js";import"./axios-CyFV80k_.js";const E=f(N)({maxWidth:600,width:"300px",margin:"auto",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",borderRadius:16,overflow:"hidden"}),B=f(h)({backgroundColor:"#1976d2",color:"#ffffff",padding:"16px",textAlign:"center"}),$=f(k)({padding:0}),A=f(h)({display:"flex",flexWrap:"wrap",gap:"4px",marginTop:"8px"}),O=({doctor:t})=>{var m;const a=[];(m=t.week_days)==null||m.forEach(d=>{a.push(`${d.day} ${H(d.date)}`)});const[s,o]=p.useState(!1),i=()=>o(!0),c=()=>o(!1);return e.jsxs(E,{children:[e.jsx(B,{children:e.jsx(l,{variant:"h5",component:"div",children:"بطاقة هوية الطبيب"})}),e.jsxs($,{children:[e.jsxs(j,{container:!0,spacing:0,alignItems:"center",children:[e.jsx(j,{item:!0,xs:4,m:1,children:e.jsx(C,{src:`http://127.0.0.1:8000${t.profile_photo}`,sx:{width:80,height:80,margin:"auto",cursor:"pointer"},onClick:i})}),e.jsxs(j,{item:!0,xs:7,children:[e.jsx(l,{variant:"h6",component:"div",children:t.name}),e.jsx(l,{color:"text.secondary",children:t.specialty})]})]}),e.jsxs(h,{mt:2,px:2,pb:2,children:[e.jsxs(l,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"الرقم القومي:"})," ",t.national_id]}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"رقم الهاتف:"})," ",t.phone_number]}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"الدرجة العلمية:"})," ",t.scientific_degree]}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"الراتب الثابت:"})," ",t.fixed_salary," جنيه"]}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"تاريخ التعيين:"})," ",new Date(t.hire_date).toLocaleDateString("ar-EG")]}),e.jsx(l,{variant:"body2",color:"text.secondary",mt:1,children:e.jsx("strong",{children:"أيام العمل:"})}),e.jsx(A,{children:a.map((d,x)=>e.jsx(I,{label:d,size:"small",color:"primary",variant:"outlined"},x))})]})]}),e.jsx(b,{open:s,onClose:c,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsx(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,p:4},children:e.jsx("img",{src:`http://127.0.0.1:8000${t.profile_photo}`,alt:"Doctor Profile",style:{maxWidth:"100%",maxHeight:"80vh"}})})})]})},H=t=>{const[a,s]=t.split(":").slice(0,2).map(Number),o=a>=12?"م":"ص",i=a%12||12,c=s.toString().padStart(2,"0");return`${i}:${c} ${o}`},P=({doctors:t,handleEditClick:a,handleDeleteClick:s})=>{const[o,i]=p.useState(null),c=r=>{i(r)},m=()=>{i(null)},d=[{field:"profile_photo",headerName:"الصوره الشخصيه",flex:.5,renderCell:r=>e.jsx("div",{style:{display:"flex",alignItems:"center",width:"100%",height:"100%",marginRight:"5px"},children:e.jsx(T,{value:`http://127.0.0.1:8000${r.value}`})})},{field:"name",headerName:"الاسم",align:"left",flex:1},{field:"fixed_salary",headerName:"االراتب",align:"left",flex:.7},{field:"phone_number",headerName:"رقم الهاتف",align:"left",flex:1},{field:"actions",headerName:"الاعدادات",align:"left",flex:1,renderCell:r=>e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"tableBtn",onClick:()=>c(r.row),children:"تفاصيل"}),e.jsx(y,{className:"tableBtn",onClick:()=>a(r.row),children:"تعديل"}),e.jsx(y,{className:"tableBtn",onClick:()=>s(r.row.id),children:"حذف"})]})}],x=t.map((r,n)=>({rowId:n+1,...r}));return t.length===0?e.jsx(w,{}):e.jsxs("div",{className:"table-wrapper",style:{flex:1,overflow:"hidden"},children:[e.jsx("h1",{style:{marginBottom:"20px"},children:"الأطباء"}),e.jsx(S,{rows:x,columns:d,getRowId:r=>r.rowId,initialState:{pagination:{paginationModel:{page:0,pageSize:5}}},pageSizeOptions:[5,8,11]}),e.jsx(b,{open:o!==null,onClose:m,"aria-labelledby":"doctor-details-modal","aria-describedby":"doctor-details-description",children:e.jsx(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxWidth:"90%",maxHeight:"90%",overflow:"auto"},children:o&&e.jsx(O,{doctor:o})})})]})},T=({value:t})=>{const[a,s]=p.useState(!1),o=()=>s(!0),i=()=>s(!1);return e.jsxs(e.Fragment,{children:[e.jsx(C,{src:t,alt:"Profile Photo",sx:{width:40,height:40,cursor:"pointer"},onClick:o}),e.jsx(b,{open:a,onClose:i,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsx(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,p:4},children:e.jsx("img",{src:t,alt:"Profile Photo",style:{maxWidth:"100%",maxHeight:"80vh"}})})})]})},ge=()=>{const[t,a]=p.useState([]),[s,o]=p.useState(!0),i=v(),{getAllDoctors:c,deleteDoctor:m}=_();p.useEffect(()=>{d()},[]);const d=async()=>{try{o(!0);const n=await c();a(n)}catch(n){console.error("Error fetching doctors:",n),u.fire({icon:"error",title:"Failed to fetch doctors"})}finally{o(!1)}},x=n=>{i("/SystemAdmin/Doctors/EditDoctor",{state:{editData:n}})},r=async n=>{try{await m(n),a(t.filter(g=>g.id!==n)),u.fire({icon:"success",title:"تمت ازاله بيانات الطبيب بنجاح."})}catch(g){console.error("Error deleting doctor:",g),u.fire({icon:"error",title:"فشلت ازاله بيانات الطبيب"})}};return s?e.jsx(D,{}):e.jsx(P,{doctors:t,handleEditClick:x,handleDeleteClick:r})};export{ge as default};
